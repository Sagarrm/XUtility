<html ng-app>
	<head>
		<title>XWalker</title>
		<link rel="stylesheet" type="text/css" href="css/tablestyle.css">
		</head>
	<body onload="startup()">
		<h2>Welcome to XWalker portal</h2>
		<h2></h2>
	
	<form name="myform" action = "/" method = "post" onsubmit="WriteCookie()">
		Store Name:<select id="storeList" required>
			<option value=""></option>
			<% strs.forEach(function(str) { %>
				<option value="<%= str %>"><%= str%></option>;
			<% }); %>
			<!--<script>
				var myArray = new Array("AllSaints","L.K. Bennett","PetSmart","Pacific Coast","Johnston & Murphy","Planet Blue","Michael Stars","Only Natural Pet","Road Runner Sports","Orvis","Tibi","Lenox","James Perse","iRobot","Three Dots","Revolve Clothing","Ernest Alexander","Swim Spot","Golf smith","Thomas Pink","Ted Baker","Neiman Marcus","Sorel","Reeds Jewelers","Free People","Stance","Veronica Beard","Pet Street Mall","Parker","Carolina Rustica","Saks Fifth Avenue","Fila","Pet Fancy","Ashley Furniture","Pet Care Choice","Bloomingdale's","Vince Camuto","NIC ZOE","Paper Source","TouchOfModern","Columbia Sportswear","Casadei","SSENSE","Billabong","Brookstone","Burke Decor","Bare Necessities","The Body Shop","Vera Bradley","Karen Millen","Macy's","7 For All Mankind","SpaceNK","Splendid","PUMA","Peace Love World| LLC","Hartford York","JAG","Design Within Reach","Donald J Pliner","Hampden Clothing","ExOfficio","Andrew Marc","Best Home Fashion Inc","Ashbury Skies","Le Creuset","LAmade Clothing","SCOOP NYC","Lulus","Sun and Ski","Kirna Zabete","Modell's Sporting Goods","Palm Beach Perfumes","Buxton Co.","Algenist","Alyaka","Black Halo","Blnts","Carole Hochman - Luxurious Lingerie","Cole Haan","Coordinates Collection","Cosabella","Crane & Co","D.L. and Co.","Durango Boots","Derek Lam","Dolce Vita","Draper James","Effy Jewelry","Fidelity Denim","French Connection","Haggar","Inhabit NY","Ink Garden","JOE'S","John Varvatos","Kate Somerville","Ledbury","OnGossamer - Luxurious| Sensual| Hip","Tailor Vintage","Volcom","KNOMOBags USA","Hudson Jeans","Citizens of Humanity");
				for(i=0; i<myArray.length; i++) {  
					document.write('<option value="' + myArray[i] +'">' + myArray[i] + '</option>');
				}
			</script>
			-->
		</select>
		<div style="display:none" ng-messages="userForm.storeList.$error" ng-messages-include="messages.html" class="errors">
		</div>
		Limit: <input id = "limit" name = "limit" type = "text" ng-model= "limit" value="" required>
		<div style="display:none" ng-messages="userForm.limit.$error" ng-messages-include="messages.html" class="errors">
		</div>
		Total Products : <%= totalNoOfProds %>
		&nbsp;&nbsp;&nbsp;&nbsp;<input type="submit" name="save" value="Apply Filter" />
		<input type="hidden" id="refreshed" value="no">
	</form>
	
	
	  
	  
	<form action = "/" method = "get" onsubmit="ClearCookie()">
	<input type="submit" name="clear" value="Clear Filter" />
	</form>

	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-messages.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>

 <script type = "text/javascript">
        
            function WriteCookie()
            {
               if( document.myform.storeList.value == "" ){
                  alert("Enter some value!");
                  return;
               }
               cookievalue= escape(document.myform.storeList.value) + ";";
			   cookievalue_1= escape(document.myform.limit.value) + ";";
			   
               document.cookie="storeValue=" + cookievalue; 
			   document.cookie="showLimit=" + cookievalue_1;
			   return;
            }
        
</script>
<script type = "text/javascript">
        
        /*    function startup()
            {
			  var cookie_string = document.cookie ;
			  if (cookie_string.length != 0) {
				var cookie_value = cookie_string.match ( '(^|;)[\s]*' + "storeValue" + '=([^;]*)' );
				document.myform.storeList.value = decodeURIComponent ( cookie_value[2] ) ;
			  }
			  return '' ;
            }
        */
		document.myform.storeList.value = rxReadCookie("storeValue");
		document.myform.limit.value = rxReadCookie("showLimit");

		function rxReadCookie(cName)
		{
		 var rslt=new RegExp(cName+"=([^;]+)\\;?", "i").exec(document.cookie?unescape(document.cookie):"");
		  
		 return rslt ? rslt[1] : "";
		}
  
</script>
<script>
function getCookie(name){
    var pattern = RegExp(name + "=.[^;]*")
    matched = document.cookie.match(pattern)
    if(matched){
        var cookie = matched[0].split('=')
        return cookie[1]
    }
    return false
}
</script>
 <script type = "text/javascript">
        
            function ClearCookie()
            {
                  document.cookie="storeValue=" + "";
				  document.cookie="showLimit=" + "";
				  
                  return;
            }
        
</script>



	  
<script>
        function ProductCategoriesCtnl($scope) {
            $scope.categories = {				
                'Women': {
                    'Accessories': {'Handbags':['Cross-Body Handbags','Hobo Handbags','Satchels','Shoulder Bags','Tote Handbags','Clutches & Special Occasion Bags','Bucket Bags','BackPacks'],'Jewelry':['Bracelets,Charms & Pendants','Cufflinks','Earrings','Necklaces','Diamonds','Rings'],'Watches':[],'Belt Buckles':[],'Belts':[],'Gloves & Mittens':[],'Hair Accessories':[],'Hats':[],'Scarves & Shawls':[],'Sunglasses':[]},
                    'Clothing': {'Activewear':['Active Dresses','Active Jackets','Active Pants','Active Shirts','Active Shorts','Active Skirts','Active Tanks','Sweatshirts','Sports Bra'],'Dresses':['Day Dresses','Formal Dresses','Cocktail Dresses','Jumpsuits & Rompers','Casual Dresses'], 'Outerwear':['Coats & Jackets','Capes & Ponchos','Casual Jackets','Puffers','Trench Coats','Raincoats'],'Pants':['Casual Pants','Dress Pants','Leggings'],'Jeans':[],'Shirts & Tops':['Camisoles & Tank Tops','Polo Shirts','Shirts & Blouses','Sweaters & Cardigans','T-Shirts'],'Shorts':[],'Skirts':[],'Sleepwear & Loungewear':['Nightgowns','Pajamas','Robes'],'Swimwear':['Cover-Ups','One-Piece Swimsuits','Swimsuit Bottoms','Swimsuit Tops','Two-Piece Swimsuits'],'Bras & Panties':['Bras','Lingerie','Shapewear','Underwear'],'Hosiery and Socks':[]},
                    'Shoes': {'Shoe Accessories':[], 'Athletic Shoes':['Cross Training Shoes','Running Shoes'], 'Clogs & Mules':[],'Flats':[],'Loafers':[],'Outdoor Shoes':[],'Oxford Shoes':[],'Pumps':['D\'orsay & Two-Piece Pumps'],'Slippers':[],'Sneakers':[],'Booties':[],'Outdoor Sandals':[],'Wedges':[],'Platform Sandals':[]},
					'shoes':{'boots':[],'sandals':['slide-sandals','thongs-flip-flops']}
                },
                'Computer': {
                    'Computer Accessories': {'Laptop Accessories':[]},
                    'Handheld Devices': {'E-Book Readers':[]},
					'Laptops':{},
					'Tablet Computers':{},
					'Chargers':{},
					'Power Adapters':{},
					'Print, Copy, Scan & Fax/Printers & Copiers':{}
                },
				'Electronics':{
					'Audio':{'Headphones':[],'MP3 Players':[]},
					'Communications':{'Mobile Phone Accessories':[],'Mobile Phones':[],'Satellite Phones':[]},
					'Electronics Accessories':{}
					
				},
				'Furniture':{
					'Baby & Toddler Furniture':{'Bassinets':[],'Changing Tables':[],'High Chairs & Boosters':[],'Beds, Cribs & Cradles':[]},
					'Bedroom Furniture':{'Armoires':[],'Bed Frames':[],'Dressers':[],'Headboards & Footboards':[],'Nightstands':[],'Storage Chests':[]},
					'Benches':{},
					'Chairs':{'Bar Stools':[],'Chaises':[],'Club Chairs':[],'Kitchen & Dining Room Chairs':[],'Living Room Chairs':[]},
					'Desks & Tables':{'Desks':[],'Kitchen & Dining Room Tables':[],'Living Room Tables':[]},
					'Kitchen & Dining Room Furniture':{'Buffets & Sideboards':[]},
					'Living Room Furniture':{'Ottomans':[]},
					'Outdoor Furniture':{},
					'Shelving':{'Bookcases':[]},
					'Sofas':{'Loveseats':[],'Sofabeds':[]},
					'Vanities':{'Bathroom Vanities':[]},
					'Wine Racks & Cellars':{'Wine Coolers':[]}
				},
				'Health & Beauty':{
					'Jewelry Cleaning & Care':{'Jewelry Boxes':[],'Jewelry Cleaners':[]},
					'Cosmetics':{'Bath & Body':{},'Cosmetic Tools':{},'Makeup':{},'Nail Care':{},'Perfume & Cologne':{},'Skin Care':{}},
					'Hair Care':{'Combs & Brushes':{},'Hair Curler Clips & Pins':{},'Hair Curlers':{},'Hair Dryers':{},'Hair Irons':{},'Hair Shears':{},'Shampoo & Conditioner':{},'Styling Gel, Spray & Mousse':{}},
					'Oral Care':{},
					'Shaving & Grooming':{'Aftershave':{},'Razors & Razor Blades':{},'Shaving Brushes':{},'Shaving Cream':{}},
					'Sleeping Aids':{'Sleep Masks':{},'Travel Pillows':{},'White Noise Machines':{}},
					'Vision Care':{'Eye Glasses':{}}
				},
				'Home & Garden':{
					'Bathroom Accessories':{'Bath Mats & Rugs':[]},
					'Decor':{'Baskets':[],'Bird Feeders':[],'Birdhouses':[],'Bookends':[],'Candle Holders':[],'Candles':[],'Clocks':[],'Decorative Plates':[],'Figurines':[],'Home Fragrances':[],'Mirrors':[],'Picture Frames':[],'Rugs':[],'Seasonal & Holiday Decorations':[],'Seating & Sofa Cushions':[],'Shadow Boxes':[],'Slipcovers':[],'Throw Pillows':[],'Vases':[],'Weather Vanes & Roof Decor':[],'Wind Chimes':[]},
					'Fire & Gas Safety':{'Fire Alarms':[]},
					'Fireplaces & Wood Stoves':{'Fireplace Tools':[]},
					'Household Appliances':{},
					'Household Supplies':{'Household Cleaning Supplies':[],'Household Paper Products':[],'Shoe Care & Tools':[],'Storage & Organization':[]},
					'Lawn & Garden':{'Gardening':[],'Outdoor Living':[]},
					'Lighting':{'Lighting/Lamps':[]},
					'Lighting Accessories':{'Lamp Shades':[]},
					'Linens':{'Bedding':[],'Table Linens':[],'Towels':[]}
				},
				'Men':{
					'Accessories':{'Neckties':['Ascot Ties'],'Pocket Squares':[],'Watches':[],'Belts':[],'Hats':[],'Gloves':[],'Sunglasses':[],'Jewelry':['Cufflinks'],'Bowties':[],'Cufflinks':[],'Scarfs':[]},
					'Clothing':{'Outerwear':['Coats & Jackets','Raincoats','Vests'],'Blazers':[],'Suits':['Pant Suits','Tuxedos','Suit Separates'],'Activewear':['Active Jackets','Active Pants','Active Shirts','Active Shorts','Active Tanks'],'Pants':[],'Jeans':[],'Shirts':[],'T-Shirts':[],'Sweaters':[],'Shorts':[],'Sleepwear & Loungewear':[],'Swimwear':['Swim Shorts'],'Traditional & Ceremonial Clothing':[],'Underwear & Socks':[],'Polo Shirts':[]},
					'Shoes':{'Boots':[],'Athletic Shoes':[],'Loafers':[],'Sandals':['Thongs & Flip-Flops'],'Slippers':[],'Sneakers':[],'Outdoor Shoes':[],'Oxford Shoes':[],'Outdoor Sandals':[],'Flip Flops':[],'Driving Shoes':[]}
				},
				'Kitchen & Dining':{
					'Bakeware':{},
					'Bakeware Accessories':{},
					'Barware':{},
					'Cookware':{},
					'Cookware Accessories':{},
					'Food & Beverage Carriers':{},
					'Food Storage':{},
					'Kitchen Appliance Accessories':{},
					'Kitchen Appliances':{},
					'Kitchen Tools & Utensils':{},
					'Tableware':{}
				},
				'Hardware':{
					'Flooring':{'Carpets':[]},
					'Tools':{}
				},
				'Luggage & Bags':{
				},
				'Gifts':{
				},
				'Pets':{
					'Dogs':{}
				}
            };
             $scope.GetSelectedPrimaryCategory = function () {
                $scope.strPrimaryCategory = document.getElementById("PrimaryCategory").value;
            };
            $scope.GetSelectedSecondaryCategory = function () {
                $scope.strSecondaryCategory = document.getElementById("SecondaryCategory").value;
            };
			 $scope.GetSelectedSubCategory = function () {
                $scope.strSubCategory = document.getElementById("SubCategory").value;
            };
			
        }
    </script>
<script type="text/javascript">
function goImgWin(myImage,myWidth,myHeight,origLeft,origTop) {
myHeight += 50;
myWidth += 50;
TheImgWin = window.open(myImage,'image','height=' +
myHeight + ',width=' + myWidth +
',toolbar=no,directories=no,status=no,' +
'menubar=no,scrollbars=no,resizable=no');
TheImgWin.moveTo(origLeft,origTop);
TheImgWin.focus();
}
</script>


<div class="CSSTableGenerator">
<form action="/" method="post"> 
    <table>
		
        <tr>
			<th>Id</th>
            <th>Category Name</th>
			<th>Product Name</th>
			<th>Store Name</th>
			<th>Short Description</th>
			<th>Product Image</th>
			<th>Category</th>
		<!--	<th>Add to values?</th>-->
        </tr>
	<% products.forEach(function(product) { %>
        <tr>
			<td><%= product.id %></td>
            <td><%= product.category_name %></td>
			<td><%= product.product_name %></td>
			<td><%= product.store_name  %></td>
			<td><%= product.short_description  %></td>
			<td><a href="<%= product.product_image %>"  onclick="goImgWin('<%= product.product_image %>',240,302,100,50);return false;"><img src="<%= product.product_image %>" width="130" height="130" border="1"
					alt="Product" class="left" /></a></td>
			<td> <div ng-controller="ProductCategoriesCtnl">
        <div>
            
            <select name="mainCategory_<%= product.id %>" ng-model="mainCategory_<%= product.id %>" ng-options="PrimaryCategory for (PrimaryCategory, cats) in categories"
                ng-change="GetSelectedPrimaryCategory()">
                <option value=''></option>
            </select>
        </div>
       
        <div>
           <select  ng-disabled="!mainCategory_<%= product.id %>" name="primaryCategory_<%= product.id %>" ng-model="primaryCategory_<%= product.id %>" ng-options="SecondaryCategory for (SecondaryCategory,SubCategory) in mainCategory_<%= product.id %>"
                ng-change="GetSelectedSecondaryCategory()"><option value=''></option>
            </select>
        </div>
		
		<div>
            <select name="secondaryCategory_<%= product.id %>" ng-disabled="!primaryCategory_<%= product.id %> || !mainCategory_<%= product.id %>" ng-model="secondaryCategory_<%= product.id %>" ng-options="SubCategory for (SubCategory,SubCat) in primaryCategory_<%= product.id %>"
				ng-change="GetSelectedSubCategory()"><option value=''></option>
            </select>
        </div>
		
		<div>
            <select  name="subCategory_<%= product.id %>" ng-disabled="!secondaryCategory_<%= product.id %> || !primaryCategory_<%= product.id %> || !mainCategory_<%= product.id %>" ng-model="subCategory_<%= product.id %>"><option value=''>
                </option>
				<option ng-repeat="SubCat in secondaryCategory_<%= product.id %>" value='{{SubCat}}'>{{SubCat}}</option>
            </select>
        </div>
		
    </div>
			</td>
			
		<!--	<td>
				<input type = "checkbox" name = "newTag_<%= product.id %>" ng-model = "newTag_<%= product.id %>">
			</td>
			-->
			
        </tr>
    <% }); %>
    </table>
	<input type="submit" name="submit" value="Submit" />
	</form>
 </div>
     
    
	
	
	</body>
</html>